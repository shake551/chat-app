<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Account</title>
</head>
<body>
  <h1>ログイン</h1>
  <form action="" name="loginForm">
    <input type="text" name="name">
    <input type="text" name="password">
    <input type="submit" value="送信" onclick="return loginCheck();">
  </form>


  <script>
    function loginCheck() {
      const name = loginForm.name.value;
      const password = loginForm.password.value;

      if (name && password) {
        getData(name, password);
      }
    }

    getData = async (name, password) => {
      const data = {
        "name": name,
        "password": password,
      }
      const res = await fetch("http://0.0.0.0:8000/api/accounts/login/", {
        method: "POST",
        body: JSON.stringify(data),
        headers: {
          'Content-Type': 'application/json'
          // 'Content-Type': 'application/x-www-form-urlencoded',
        },
      });

      //responseオブジェクトからJSONオブジェクトを抽出
      const json = await res.json();

      //取得できたJSONオブジェクトをJSON文字列化して表示
      const string_res = JSON.stringify(json);
      console.log(string_res);
      console.log(json["token"]['refresh_token']);
      
      // 取得したtokenをlocalstrageに保存
      window.localStorage.setItem('refresh_token', json['token']['refresh_token']);
      window.localStorage.setItem('access_token', json['token']['access_token']);

      // localstrageに保存した値を取得
      console.log(window.localStorage.getItem('refresh_token'));
      console.log(window.localStorage.getItem('access_token'));
    };
  </script>
</body>
</html>